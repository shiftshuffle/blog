  

<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>Padding Oracle Attack &middot; Matheux</title>
  <link rel="stylesheet" href="http://shiftshuffle.github.io/blog//css/style2.css" />
  <link rel="stylesheet" href="http://shiftshuffle.github.io/blog//css/font-awesome.min.css" />
  <link href='https://fonts.googleapis.com/css?family=Lato:100,300,400,600' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="http://shiftshuffle.github.io/blog//css/prism.css" data-noprefix />

  
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> 

  
<link  href="http://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet"> 
<script src="http://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script> 


  




   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        
        
        
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        },
         config: ["MMLorHTML.js"],
  jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
  extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
  }
  
    });
    </script>
    


<style>

</style>



</head>


<body>

<header class="header" style="background: linear-gradient(rgba(0,0,0,.5), rgba(0,0,0,.5)), url(http://shiftshuffle.github.io/blog/img/antiquitera2.jpg) 29.9% 29.9% / cover;" role="banner">
<!-- featuredimage. Otherwise show default //-->

      <section id="branding">
        <div id="site-title"><a href="http://shiftshuffle.github.io/blog/">Matheux</a></div>
        <nav id="mainmenu">
          <ul>
            <li><a href="http://shiftshuffle.github.io/blog/">Articles</a></li>
            <li><a href="https://github.com/shiftshuffle" target="_blank">Github</a></li>
            <li><a href="https://www.facebook.com/galois.fermat" target="_blank">Facebook</a></li>
            
          </ul>
        </nav>
        <input type="checkbox" id="op"></input>
        <div class="lower">
          <label for="op">Menu</label>
        </div>
        <div class="overlay overlay-hugeinc">
          <label for="op"></label>
          <nav id="menu" role="navigation">
            <ul>
            <li><a href="http://shiftshuffle.github.io/blog/">Articles</a></li>
            <li><a href="https://github.com/shiftshuffle" target="_blank">Github</a></li>
            <li><a href="https://www.facebook.com/galois.fermat" target="_blank">Facebook</a></li>
            
          </ul>
          </nav>
        </div>
        <div class="clearfix"></div>
      </section>
      <div class="post-heading">
        <h1>
        Padding Oracle Attack
          <div class="share-icons-header">
            <a href="http://www.twitter.com/share?url=http%3a%2f%2fshiftshuffle.github.io%2fblog%2fpost%2fpaddingoracle%2f" target="_blank">
            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 612 612" style="enable-background:new 0 0 612 612;" xml:space="preserve">
            <g>
              <g>
                <path d="M437.219,245.162c0-3.088-0.056-6.148-0.195-9.18c13.214-9.848,24.675-22.171,33.744-36.275
                  c-12.129,5.453-25.148,9.097-38.835,10.626c13.965-8.596,24.675-22.338,29.738-38.834c-13.075,7.928-27.54,13.603-42.924,16.552
                  c-12.323-14.021-29.904-22.95-49.35-23.284c-37.332-0.612-67.598,30.934-67.598,70.463c0,5.619,0.584,11.072,1.752,16.329
                  c-56.22-3.616-106.042-32.881-139.369-77c-5.814,10.571-9.152,22.922-9.152,36.164c0,25.037,11.934,47.291,30.071,60.421
                  c-11.099-0.5-21.503-3.866-30.627-9.375c0,0.306,0,0.612,0,0.918c0,34.996,23.312,64.316,54.245,71.159
                  c-5.675,1.613-11.656,2.448-17.804,2.421c-4.367-0.028-8.596-0.501-12.713-1.392c8.596,28.681,33.577,49.628,63.147,50.323
                  c-23.145,19.194-52.298,30.655-83.955,30.572c-5.453,0-10.849-0.361-16.135-1.029c29.933,20.53,65.456,32.491,103.65,32.491
                  C369.23,447.261,437.219,339.048,437.219,245.162z"/>
                <path d="M612,306C612,137.004,474.995,0,306,0C137.004,0,0,137.004,0,306c0,168.995,137.004,306,306,306
                  C474.995,612,612,474.995,612,306z M27.818,306C27.818,152.36,152.36,27.818,306,27.818S584.182,152.36,584.182,306
                  S459.64,584.182,306,584.182S27.818,459.64,27.818,306z"/>
              </g>
            </svg></a>
            <a href="http://plus.google.com/share?url=http%3a%2f%2fshiftshuffle.github.io%2fblog%2fpost%2fpaddingoracle%2f" target="_blank">
            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 612 612" style="enable-background:new 0 0 612 612;" xml:space="preserve">
              <g>
                <g>
                  <path d="M349.146,402.251c0-30.016-17.387-44.815-36.525-60.922l-15.662-12.185c-4.785-3.895-11.294-9.124-11.294-18.693
                    c0-9.57,6.537-15.662,12.184-21.309c18.249-14.354,36.526-29.571,36.526-61.756c0-33.076-20.892-50.462-30.878-58.724l0,0h26.956
                    L358.271,153h-89.603c-23.479,0-53.049,3.478-77.863,23.924c-18.693,16.079-27.818,38.278-27.818,58.279
                    c0,33.911,26.093,68.294,72.188,68.294c4.368,0,9.125-0.445,13.937-0.863c-2.17,5.23-4.34,9.569-4.34,16.97
                    c0,13.464,6.955,21.753,13.047,29.57c-19.556,1.308-56.109,3.478-83.065,20.001c-25.676,15.217-33.493,37.416-33.493,53.077
                    c0,32.186,30.461,62.201,93.525,62.201C309.561,484.454,349.146,443.116,349.146,402.251z M255.621,291.34
                    c-37.415,0-54.384-48.292-54.384-77.418c0-11.322,2.17-23.034,9.569-32.186c6.955-8.707,19.139-14.382,30.461-14.382
                    c36.108,0,54.802,48.738,54.802,80.033c0,7.845-0.862,21.754-10.877,31.768C278.237,286.11,266.498,291.312,255.621,291.34z
                     M256.066,466.177c-46.54,0-76.556-22.171-76.556-53.049s27.846-41.311,37.416-44.787c18.276-6.093,41.755-6.982,45.677-6.982
                    c4.34,0,6.51,0,9.987,0.445c33.076,23.479,47.402,35.218,47.402,57.416C319.992,446.176,297.821,466.177,256.066,466.177z"/>
                  <polygon points="353.068,317.768 400.164,317.768 400.164,364.836 423.699,364.836 423.699,317.768 470.768,317.768 
                    470.768,294.233 423.699,294.233 423.699,247.165 400.164,247.165 400.164,294.233 353.068,294.233     "/>
                  <path d="M612,306C612,137.004,474.995,0,306,0C137.004,0,0,137.004,0,306c0,168.995,137.004,306,306,306
                    C474.995,612,612,474.995,612,306z M27.818,306C27.818,152.36,152.36,27.818,306,27.818S584.182,152.36,584.182,306
                    S459.64,584.182,306,584.182S27.818,459.64,27.818,306z"/>
                </g>
            </svg></a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fshiftshuffle.github.io%2fblog%2fpost%2fpaddingoracle%2f" target="_blank">
            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               viewBox="0 0 612 612" style="enable-background:new 0 0 612 612;" xml:space="preserve">
            <g>
              <g>
                <path d="M612,306C612,137.004,474.995,0,306,0C137.004,0,0,137.004,0,306c0,168.995,137.004,306,306,306
                  C474.995,612,612,474.995,612,306z M27.818,306C27.818,152.36,152.36,27.818,306,27.818S584.182,152.36,584.182,306
                  S459.64,584.182,306,584.182S27.818,459.64,27.818,306z"/>
                <path d="M317.739,482.617V306h58.279l9.208-58.529h-67.487v-29.348c0-15.272,5.007-29.849,26.928-29.849h43.813v-58.418h-62.201
                  c-52.298,0-66.569,34.438-66.569,82.175v35.413h-35.885V306h35.885v176.617H317.739L317.739,482.617z"/>
              </g>
            </svg>
            </a>
          </div>
          
        </h1>
      </div>

    </header>

    <div id="container">


<section id="content" role="main">
<section class="entry-meta">
  <span class="post-date">Jun 20, 2016</span>
</section></header>
<section class="entry-content">
<article>


<h1 id="crypto">Crypto</h1>

<p>This is an example of why in crypto implementation is crucial, it doesn&rsquo;t matter if you have a steel door, it doesn&rsquo;t do its function if you have a broken window.</p>

<p>An exercise i solved as part of the special assignments in <a href="https://www.coursera.org/learn/crypto">Cryptogaphy I</a> by professor of Stanford Dan Boneh, was to crack a crypted id because it was implemented badly in CBC mode, we where able to know whether our guesses were well padded or not, and that leaked information that we could use in our advantage, i won&rsquo;t get in the details since i just found that Rob Heaton has a good explanation in his <a href="http://robertheaton.com/2013/07/29/padding-oracle-attack/">blog</a></p>

<p>I would say also that i love challenges like <a href="http://cryptopals.com/">the crypto challenges</a> :)</p>

<div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-julia"><pre><span class="k">using</span> <span class="n">Requests</span>

<span class="k">function</span><span class="nf"> letmesee</span><span class="p">(</span><span class="n">guess</span><span class="p">::</span><span class="n">String</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="o">*</span><span class="n">guess</span><span class="p">)</span><span class="o">.</span><span class="n">status</span><span class="o">==</span><span class="mi">404</span>
        <span class="k">return</span> <span class="n">true</span>
        <span class="k">else</span>
            <span class="k">return</span> <span class="n">false</span>
    <span class="k">end</span>
<span class="k">end</span>


<span class="k">function</span><span class="nf"> hex2bin</span><span class="p">(</span><span class="n">s</span><span class="p">::</span><span class="n">ASCIIString</span><span class="p">)</span>
    <span class="n">len</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">isodd</span><span class="p">(</span><span class="n">len</span><span class="p">)</span>
        <span class="nb">error</span><span class="p">(</span><span class="s">&quot;Input string length should be even&quot;</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="kt">Uint8</span><span class="p">,</span> <span class="n">div</span><span class="p">(</span><span class="n">len</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+=</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;9&#39;</span> <span class="o">?</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span> <span class="p">:</span>
            <span class="sc">&#39;a&#39;</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;f&#39;</span> <span class="o">?</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span> <span class="o">+</span> <span class="mi">10</span> <span class="p">:</span>
            <span class="sc">&#39;A&#39;</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;F&#39;</span> <span class="o">?</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;A&#39;</span> <span class="o">+</span> <span class="mi">10</span> <span class="p">:</span> <span class="nb">error</span><span class="p">(</span><span class="s">&quot;Input string isn&#39;t a hexadecimal string&quot;</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+=</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;9&#39;</span> <span class="o">?</span> <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span> <span class="p">:</span>
            <span class="sc">&#39;a&#39;</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;f&#39;</span> <span class="o">?</span> <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span> <span class="o">+</span> <span class="mi">10</span> <span class="p">:</span>
            <span class="sc">&#39;A&#39;</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;F&#39;</span> <span class="o">?</span> <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;A&#39;</span> <span class="o">+</span> <span class="mi">10</span> <span class="p">:</span> <span class="nb">error</span><span class="p">(</span><span class="s">&quot;Input string isn&#39;t a hexadecimal string&quot;</span><span class="p">)</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+=</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">arr</span>
<span class="k">end</span>

<span class="n">bin2hex</span><span class="p">(</span><span class="n">arr</span><span class="p">::</span><span class="n">Array</span><span class="p">{</span><span class="kt">Uint8</span><span class="p">,</span><span class="mi">1</span><span class="p">})</span> <span class="o">=</span> <span class="n">join</span><span class="p">([</span><span class="n">hex</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">arr</span><span class="p">])</span>
</pre></div>

<p></div>
</div>
</div></p>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[2]:</div>

<div class="output_text output_subarea output_execute_result">
<pre>bin2hex (generic function with 1 method)</pre>
</div>

<p></div></p>

<p></div>
</div></p>

<p></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-julia"><pre><span class="n">target</span> <span class="o">=</span> <span class="s">&quot;<a href="http://crypto-class.appspot.com/po?er=&quot;">http://crypto-class.appspot.com/po?er=&quot;</a></span>
<span class="n">crypted</span><span class="o">=</span> <span class="s">&quot;f20bdba6ff29eed7b046d1df9fb7000058b1ffb4210a580f748b4ac714c001bd4a61044426fb515dad3f21f18aa577c0bdf302936266926ff37dbf7035d5eeb4&quot;</span>
<span class="n">data</span><span class="o">=</span><span class="n">hex2bin</span><span class="p">(</span><span class="n">crypted</span><span class="p">)</span>
<span class="n">blocks</span><span class="o">=</span><span class="n">Array</span><span class="p">[]</span>
<span class="n">clair</span><span class="o">=</span><span class="p">[</span><span class="kt">Uint8</span><span class="p">[]</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span></p>

<p><span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">int</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">push</span><span class="o">!</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span><span class="n">data</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o"><em></span><span class="mi">16</span><span class="o">+</span><span class="mi">1</span><span class="p">:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o"></em></span><span class="mi">16</span><span class="o">+</span><span class="mi">16</span><span class="p">])</span>
<span class="k">end</span></p>

<p><span class="k">for</span> <span class="n">h</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span>
    <span class="n">pad</span><span class="o">=</span><span class="nb">convert</span><span class="p">(</span><span class="kt">Uint8</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">block</span><span class="o">=</span><span class="kt">Uint8</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">blocks</span><span class="p">[</span><span class="n">h</span><span class="p">]]</span>
    <span class="n">block</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">block</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">$</span><span class="mi">1</span></p>

<p><span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">:</span><span class="mi">255</span>
<span class="n">g</span><span class="o">=</span><span class="nb">convert</span><span class="p">(</span><span class="kt">Uint8</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="n">block</span><span class="p">[</span><span class="k">end</span><span class="p">]</span><span class="o">=</span><span class="n">blocks</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="k">end</span><span class="p">]</span><span class="o">$</span><span class="n">g</span><span class="o">$</span><span class="n">pad</span>
<span class="n">guess</span><span class="o">=</span><span class="n">bin2hex</span><span class="p">(</span><span class="n">block</span><span class="p">)</span><span class="o">*</span><span class="n">bin2hex</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="k">if</span> <span class="n">letmesee</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span>
     <span class="n">println</span><span class="p">(</span><span class="n">char</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
    <span class="n">push</span><span class="o">!</span><span class="p">(</span><span class="n">clair</span><span class="p">[</span><span class="n">h</span><span class="p">],</span><span class="n">g</span><span class="p">)</span>
    <span class="k">break</span>
<span class="k">end</span>
<span class="k">end</span></p>

<p><span class="k">for</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">:</span><span class="mi">16</span>
<span class="n">pad</span><span class="o">=</span><span class="nb">convert</span><span class="p">(</span><span class="kt">Uint8</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<span class="n">block</span><span class="o">=</span><span class="kt">Uint8</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">blocks</span><span class="p">[</span><span class="n">h</span><span class="p">]]</span></p>

<p><span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">block</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">block</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">$</span><span class="n">clair</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">$</span><span class="n">pad</span>
<span class="k">end</span></p>

<p><span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">:</span><span class="mi">255</span>
    <span class="n">g</span><span class="o">=</span><span class="nb">convert</span><span class="p">(</span><span class="kt">Uint8</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">block</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">blocks</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="k">end</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">$</span><span class="n">g</span><span class="o">$</span><span class="n">pad</span>
    <span class="n">guess</span><span class="o">=</span><span class="n">bin2hex</span><span class="p">(</span><span class="n">block</span><span class="p">)</span><span class="o">*</span><span class="n">bin2hex</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">letmesee</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span>
         <span class="c">#println(char(g))</span>
        <span class="n">push</span><span class="o">!</span><span class="p">(</span><span class="n">clair</span><span class="p">[</span><span class="n">h</span><span class="p">],</span><span class="n">g</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">end</span>
<span class="k">end</span>
<span class="k">end</span>
<span class="k">end</span></p>

<p><span class="n">println</span><span class="p">(</span><span class="n">clair</span><span class="p">)</span></p>

<p><span class="n">reverse</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">char</span><span class="p">,</span><span class="n">clair</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span><span class="o"><em></span><span class="n">reverse</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">char</span><span class="p">,</span><span class="n">clair</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span><span class="o"></em></span><span class="n">reverse</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">char</span><span class="p">,</span><span class="n">clair</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>
</pre></div></p>

<p></div>
</div>
</div></p>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre> 
s
    
[Uint8[32,115,100,114,111,87,32,99,105,103,97,77,32,101,104,84],Uint8[115,79,32,104,115,105,109,97,101,117,113,83,32,101,114,97],Uint8[9,9,9,9,9,9,9,9,9,101,103,97,114,102,105,115]]
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[3]:</div>

<div class="output_text output_subarea output_execute_result">
<pre>&quot;The Magic Words are Squeamish Ossifrage\t\t\t\t\t\t\t\t\t&quot;</pre>
</div>

<p></div></p>

<p></div>
</div></p>

<p></div>
    </div>
  </div></p>

</section>
<div class="entry-links"></div>
</article>
<div class="share-icons-body">
  <a href="http://www.twitter.com/share?url=http%3a%2f%2fshiftshuffle.github.io%2fblog%2fpost%2fpaddingoracle%2f" target="_blank">
  <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 612 612" style="enable-background:new 0 0 612 612;" xml:space="preserve">
  <g>
    <g>
      <path d="M437.219,245.162c0-3.088-0.056-6.148-0.195-9.18c13.214-9.848,24.675-22.171,33.744-36.275
        c-12.129,5.453-25.148,9.097-38.835,10.626c13.965-8.596,24.675-22.338,29.738-38.834c-13.075,7.928-27.54,13.603-42.924,16.552
        c-12.323-14.021-29.904-22.95-49.35-23.284c-37.332-0.612-67.598,30.934-67.598,70.463c0,5.619,0.584,11.072,1.752,16.329
        c-56.22-3.616-106.042-32.881-139.369-77c-5.814,10.571-9.152,22.922-9.152,36.164c0,25.037,11.934,47.291,30.071,60.421
        c-11.099-0.5-21.503-3.866-30.627-9.375c0,0.306,0,0.612,0,0.918c0,34.996,23.312,64.316,54.245,71.159
        c-5.675,1.613-11.656,2.448-17.804,2.421c-4.367-0.028-8.596-0.501-12.713-1.392c8.596,28.681,33.577,49.628,63.147,50.323
        c-23.145,19.194-52.298,30.655-83.955,30.572c-5.453,0-10.849-0.361-16.135-1.029c29.933,20.53,65.456,32.491,103.65,32.491
        C369.23,447.261,437.219,339.048,437.219,245.162z"/>
      <path d="M612,306C612,137.004,474.995,0,306,0C137.004,0,0,137.004,0,306c0,168.995,137.004,306,306,306
        C474.995,612,612,474.995,612,306z M27.818,306C27.818,152.36,152.36,27.818,306,27.818S584.182,152.36,584.182,306
        S459.64,584.182,306,584.182S27.818,459.64,27.818,306z"/>
    </g>
  </svg></a>
  <a href="http://plus.google.com/share?url=http%3a%2f%2fshiftshuffle.github.io%2fblog%2fpost%2fpaddingoracle%2f" target="_blank">
  <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 612 612" style="enable-background:new 0 0 612 612;" xml:space="preserve">
    <g>
      <g>
        <path d="M349.146,402.251c0-30.016-17.387-44.815-36.525-60.922l-15.662-12.185c-4.785-3.895-11.294-9.124-11.294-18.693
          c0-9.57,6.537-15.662,12.184-21.309c18.249-14.354,36.526-29.571,36.526-61.756c0-33.076-20.892-50.462-30.878-58.724l0,0h26.956
          L358.271,153h-89.603c-23.479,0-53.049,3.478-77.863,23.924c-18.693,16.079-27.818,38.278-27.818,58.279
          c0,33.911,26.093,68.294,72.188,68.294c4.368,0,9.125-0.445,13.937-0.863c-2.17,5.23-4.34,9.569-4.34,16.97
          c0,13.464,6.955,21.753,13.047,29.57c-19.556,1.308-56.109,3.478-83.065,20.001c-25.676,15.217-33.493,37.416-33.493,53.077
          c0,32.186,30.461,62.201,93.525,62.201C309.561,484.454,349.146,443.116,349.146,402.251z M255.621,291.34
          c-37.415,0-54.384-48.292-54.384-77.418c0-11.322,2.17-23.034,9.569-32.186c6.955-8.707,19.139-14.382,30.461-14.382
          c36.108,0,54.802,48.738,54.802,80.033c0,7.845-0.862,21.754-10.877,31.768C278.237,286.11,266.498,291.312,255.621,291.34z
           M256.066,466.177c-46.54,0-76.556-22.171-76.556-53.049s27.846-41.311,37.416-44.787c18.276-6.093,41.755-6.982,45.677-6.982
          c4.34,0,6.51,0,9.987,0.445c33.076,23.479,47.402,35.218,47.402,57.416C319.992,446.176,297.821,466.177,256.066,466.177z"/>
        <polygon points="353.068,317.768 400.164,317.768 400.164,364.836 423.699,364.836 423.699,317.768 470.768,317.768 
          470.768,294.233 423.699,294.233 423.699,247.165 400.164,247.165 400.164,294.233 353.068,294.233     "/>
        <path d="M612,306C612,137.004,474.995,0,306,0C137.004,0,0,137.004,0,306c0,168.995,137.004,306,306,306
          C474.995,612,612,474.995,612,306z M27.818,306C27.818,152.36,152.36,27.818,306,27.818S584.182,152.36,584.182,306
          S459.64,584.182,306,584.182S27.818,459.64,27.818,306z"/>
      </g>
  </svg></a>
  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fshiftshuffle.github.io%2fblog%2fpost%2fpaddingoracle%2f" target="_blank">
  <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     viewBox="0 0 612 612" style="enable-background:new 0 0 612 612;" xml:space="preserve">
  <g>
    <g>
      <path d="M612,306C612,137.004,474.995,0,306,0C137.004,0,0,137.004,0,306c0,168.995,137.004,306,306,306
        C474.995,612,612,474.995,612,306z M27.818,306C27.818,152.36,152.36,27.818,306,27.818S584.182,152.36,584.182,306
        S459.64,584.182,306,584.182S27.818,459.64,27.818,306z"/>
      <path d="M317.739,482.617V306h58.279l9.208-58.529h-67.487v-29.348c0-15.272,5.007-29.849,26.928-29.849h43.813v-58.418h-62.201
        c-52.298,0-66.569,34.438-66.569,82.175v35.413h-35.885V306h35.885v176.617H317.739L317.739,482.617z"/>
    </g>
  </svg>
  </a>
</div>
<div class="clearfix"></div>
<figure class="author-bio">
<img class="bio-image" src="../../img/2.jpg" />


<figcaption class="bio-text"> "La pensée n'est qu'un écliar au milieu d'une longue nuit. Mais c'est cet éclair qui est tout." <br /><br />
"Thought is only a flash in the middle of a long night. But this flash means everything. " <br /><br />
- Henri Poincaré
</figcaption>  
</figure>  
<hr>



</section>
<div class="clear"></div>
</div>
<footer id="footer" style="color: #7A7B7C; background-color: #3A3B3C;background-image: url(http://shiftshuffle.github.io/blog//img/texture.png),linear-gradient(to bottom, #3A3B3C, #1d1e1e); background-repeat: repeat, no-repeat; background-position: left top, left top; background-size: 100px 100px, 100% 100%;">
  <div id="footer-container">
  <div class="footer-column">Some text here.</div>
  <div class="footer-column">Some different text here.</div>
  <div class="footer-column">Even more different text here.</div>
  <div class="clearfix"></div>
  </div>
  <div id="copyright"></div>
</footer>
<script src="http://shiftshuffle.github.io/blog//js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'Your Google Analytics tracking id', 'auto');
    ga('send', 'pageview');
  </script>

  <script src="